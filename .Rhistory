#displaying the html page
#results_antwerp_2
names_antwerp <- results_antwerp_2 %>%
html_nodes("li") %>%
html_text()
names_antwerp
url_antwerp<- results_antwerp_2 %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp #list of individual links from page one
results_df_antwerp_2 <- tibble(names_antwerp, url_antwerp)
results_df_antwerp_2
#url
results_df_antwerp_2 <- results_df_antwerp_2 %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df_antwerp_2
df_antwerp_smith <- bind_rows(results_df_antwerp, results_df_antwerp_2)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(xlsx)
library(writexl)
results_antwerp <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=56%2C79%2C542&subjectmat=&place=Antwerpen&gender=&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
#displaying the html page
#results_antwerp
names_antwerp <- results_antwerp %>%
html_nodes("li") %>%
html_text()
names_antwerp
url_antwerp <- results_antwerp %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp #list of individual links from page one
results_df_antwerp <- tibble(names_antwerp, url_antwerp)
results_df_antwerp
#url
results_df_antwerp <- results_df_antwerp %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df_antwerp
results_antwerp_2 <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=56%2C79%2C542&subjectmat=&place=Antwerpen&gender=&year_start=1556&year_end=1725&formtype=selections&page=2&subtask=selections")
#displaying the html page
#results_antwerp_2
names_antwerp <- results_antwerp_2 %>%
html_nodes("li") %>%
html_text()
names_antwerp
url_antwerp<- results_antwerp_2 %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp #list of individual links from page one
results_df_antwerp_2 <- tibble(names_antwerp, url_antwerp)
results_df_antwerp_2
#url
results_df_antwerp_2 <- results_df_antwerp_2 %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df_antwerp_2
df_antwerp_smith <- bind_rows(results_df_antwerp, results_df_antwerp_2)
View(df_antwerp_smith)
write_xlsx(x = df_antwerp_smith, path = "antwerp_smith_data.xlsx", col_names = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(xlsx)
library(writexl)
results_antwerp_book <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=28%2C663%2C29%2C658%2C32%2C30%2C1028%2C243&subjectmat=&place=antwerpen&gender=&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
#displaying the html page
#results_antwerp
names_antwerp_book <- results_antwerp_book %>%
html_nodes("li") %>%
html_text()
names_antwerp_book
url_antwerp_book <- results_antwerp_book %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp_book #list of individual links from page one
results_df_antwerp_book <- tibble(names_antwerp_book, url_antwerp_book)
results_df_antwerp_book
results_df_antwerp_book <- results_df_antwerp_book %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp_book}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df_antwerp_book
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(xlsx)
library(writexl)
results_antwerp_book <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=28%2C663%2C29%2C658%2C32%2C30%2C1028%2C243&subjectmat=&place=antwerpen&gender=&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
#displaying the html page
#results_antwerp
names_antwerp_book <- results_antwerp_book %>%
html_nodes("li") %>%
html_text()
names_antwerp_book
url_antwerp_book <- results_antwerp_book %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp_book #list of individual links from page one
results_df_antwerp_book <- tibble(names_antwerp_book, url_antwerp_book)
results_df_antwerp_book
results_df_antwerp_book <- results_df_antwerp_book %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp_book}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df_antwerp_book
results_antwerp_book2 <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=28%2C663%2C29%2C658%2C32%2C30%2C1028%2C243&subjectmat=&place=antwerpen&gender=&year_start=1556&year_end=1725&formtype=selections&page=2&subtask=selections")
#displaying the html page
#results_antwerp_2
names_antwerp_book <- results_antwerp_book2 %>%
html_nodes("li") %>%
html_text()
names_antwerp_book
url_antwerp_book <- results_antwerp_book2 %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp_book #list of individual links from page one
results_df_antwerp_book2 <- tibble(names_antwerp_book, url_antwerp_book)
results_df_antwerp_book2
results_df_antwerp_book2 <- results_df_antwerp_book2 %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp_book}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df_antwerp_book2
df_antwerp_book <- bind_rows(results_df_antwerp_book, results_df_antwerp_book2)
View(df_antwerp_book)
write_xlsx(x = df_antwerp_book, path = "antwerp_book_data.xlsx", col_names = TRUE)
View(results)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(xlsx)
library(writexl)
results_antwerp_book <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=28%2C663%2C29%2C658%2C32%2C30%2C1028%2C243&subjectmat=&place=antwerpen&gender=male&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
#displaying the html page
#results_antwerp
names_antwerp_book <- results_antwerp_book %>%
html_nodes("li") %>%
html_text()
names_antwerp_book
url_antwerp_book <- results_antwerp_book %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp_book #list of individual links from page one
results_df_antwerp_book <- tibble(names_antwerp_book, url_antwerp_book)
results_df_antwerp_book
results_df_antwerp_book <- results_df_antwerp_book %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp_book}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df_antwerp_book
names_antwerp_book <- results_antwerp_book2 %>%
html_nodes("li") %>%
html_text()
names_antwerp_book
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(xlsx)
library(writexl)
results_antwerp_book <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=28%2C663%2C29%2C658%2C32%2C30%2C1028%2C243&subjectmat=&place=antwerpen&gender=male&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
#displaying the html page
#results_antwerp
names_antwerp_book <- results_antwerp_book %>%
html_nodes("li") %>%
html_text()
names_antwerp_book
url_antwerp_book <- results_antwerp_book %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp_book #list of individual links from page one
results_df_antwerp_book <- tibble(names_antwerp_book, url_antwerp_book)
results_df_antwerp_book
results_df_antwerp_book <- results_df_antwerp_book %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp_book}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df_antwerp_book
results_antwerp_book2 <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=28%2C663%2C29%2C658%2C32%2C30%2C1028%2C243&subjectmat=&place=antwerpen&gender=male&year_start=1556&year_end=1725&formtype=selections&page=2&subtask=selections")
#displaying the html page
#results_antwerp_2
names_antwerp_book <- results_antwerp_book2 %>%
html_nodes("li") %>%
html_text()
names_antwerp_book
url_antwerp_book <- results_antwerp_book2 %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp_book #list of individual links from page one
results_df_antwerp_book2 <- tibble(names_antwerp_book, url_antwerp_book)
results_df_antwerp_book2
results_df_antwerp_book2 <- tibble(names_antwerp_book, url_antwerp_book)
results_df_antwerp_book2
results_df_antwerp_book2 <- results_df_antwerp_book2 %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp_book}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df_antwerp_book2
df_antwerp_book <- bind_rows(results_df_antwerp_book, results_df_antwerp_book2)
write_xlsx(x = df_antwerp_book, path = "antwerp_book_data.xlsx", col_names = TRUE)
knitr::opts_chunk$set(echo = TRUE)
results_df_antwerp_book2 <- tibble(names_antwerp_book, url_antwerp_book)
results_antwerp_book_fem <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=28%2C663%2C29%2C658%2C32%2C30%2C1028%2C243&subjectmat=&place=antwerpen&gender=female&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(xlsx)
library(writexl)
results_antwerp_book <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=28%2C663%2C29%2C658%2C32%2C30%2C1028%2C243&subjectmat=&place=antwerpen&gender=male&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
names_antwerp_book <- results_antwerp_book %>%
html_nodes("li") %>%
html_text()
names_antwerp_book
url_antwerp_book <- results_antwerp_book %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp_book #list of individual links from page one
results_df_antwerp_book <- tibble(names_antwerp_book, url_antwerp_book)
results_df_antwerp_book
results_df_antwerp_book <- results_df_antwerp_book %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp_book}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df_antwerp_book
results_antwerp_book2 <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=28%2C663%2C29%2C658%2C32%2C30%2C1028%2C243&subjectmat=&place=antwerpen&gender=male&year_start=1556&year_end=1725&formtype=selections&page=2&subtask=selections")
names_antwerp_book <- results_antwerp_book2 %>%
html_nodes("li") %>%
html_text()
#names_antwerp_book
url_antwerp_book <- results_antwerp_book2 %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp_book #list of individual links from page one
results_df_antwerp_book2 <- tibble(names_antwerp_book, url_antwerp_book)
#results_df_antwerp_book2
results_df_antwerp_book2 <- results_df_antwerp_book2 %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp_book}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
#results_df_antwerp_book2
df_antwerp_book <- bind_rows(results_df_antwerp_book, results_df_antwerp_book2)
write_xlsx(x = df_antwerp_book, path = "antwerp_book_data.xlsx", col_names = TRUE)
results_antwerp_book_fem <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=28%2C663%2C29%2C658%2C32%2C30%2C1028%2C243&subjectmat=&place=antwerpen&gender=female&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
names_antwerp_book_fem <- results_antwerp_book_fem %>%
html_nodes("li") %>%
html_text()
names_antwerp_book_fem
results_df_antwerp_book_fem <- results_df_antwerp_book_fem %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp_book_fem}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rvest)
library(xlsx)
library(writexl)
results_antwerp_book <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=28%2C663%2C29%2C658%2C32%2C30%2C1028%2C243&subjectmat=&place=antwerpen&gender=male&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
names_antwerp_book <- results_antwerp_book %>%
html_nodes("li") %>%
html_text()
names_antwerp_book
url_antwerp_book <- results_antwerp_book %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp_book #list of individual links from page one
results_df_antwerp_book <- tibble(names_antwerp_book, url_antwerp_book)
results_df_antwerp_book
results_df_antwerp_book <- results_df_antwerp_book %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp_book}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df_antwerp_book
results_antwerp_book2 <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=28%2C663%2C29%2C658%2C32%2C30%2C1028%2C243&subjectmat=&place=antwerpen&gender=male&year_start=1556&year_end=1725&formtype=selections&page=2&subtask=selections")
names_antwerp_book <- results_antwerp_book2 %>%
html_nodes("li") %>%
html_text()
#names_antwerp_book
url_antwerp_book <- results_antwerp_book2 %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp_book #list of individual links from page one
results_df_antwerp_book2 <- tibble(names_antwerp_book, url_antwerp_book)
#results_df_antwerp_book2
results_df_antwerp_book2 <- results_df_antwerp_book2 %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp_book}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
#results_df_antwerp_book2
df_antwerp_book <- bind_rows(results_df_antwerp_book, results_df_antwerp_book2)
write_xlsx(x = df_antwerp_book, path = "antwerp_book_data.xlsx", col_names = TRUE)
results_antwerp_book_fem <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=28%2C663%2C29%2C658%2C32%2C30%2C1028%2C243&subjectmat=&place=antwerpen&gender=female&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
names_antwerp_book_fem <- results_antwerp_book_fem %>%
html_nodes("li") %>%
html_text()
names_antwerp_book_fem
url_antwerp_book_fem <- results_antwerp_book_fem %>%
html_nodes("li a") %>%
html_attr("href")
url_antwerp_book_fem #list of individual links from page one
results_df_antwerp_book_fem <- tibble(names_antwerp_book_fem, url_antwerp_book_fem)
#results_df_antwerp_book2
results_df_antwerp_book_fem <- results_df_antwerp_book_fem %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url_antwerp_book_fem}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df_antwerp_book_fem
write_xlsx(x = df_antwerp_book_fem, path = "antwerp_book_fem_data.xlsx", col_names = TRUE)
write_xlsx(x = results_df_antwerp_book_fem, path = "antwerp_book_fem_data.xlsx", col_names = TRUE)
View(results_antwerp_book2)
knitr::opts_chunk$set(echo = TRUE)
results_antwerp_engraver <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=81%2C121%2C152&subjectmat=&place=antwerpen&gender=male&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
results_antwerp_engraver <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=81%2C121%2C152&subjectmat=&place=antwerpen&gender=male&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
results_antwerp_engraver <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=81%2C121%2C152&subjectmat=&place=antwerpen&gender=male&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
results_antwerp_engraver
results_antwerp_engraver <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=81%2C121%2C152&subjectmat=&place=antwerpen&gender=male&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
#results_antwerp_engraver
url <- results %>%
html_nodes("li a") %>%
html_attr("href")
library(tidyverse)
library(rvest)
results <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?subtask=browse")
results
names <- results %>%
html_nodes("li") %>%
html_text()
names
url <- results %>%
html_nodes("li a") %>%
html_attr("href")
url
results_df <- tibble(names, url)
results_df
results_df <- results_df %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df
results_page2 <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?subtask=browse&field=surname&strtchar=A&page=2")
library(tidyverse)
library(rvest)
results <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?subtask=browse")
results
names <- results %>%
html_nodes("li") %>%
html_text()
names
url <- results %>%
html_nodes("li a") %>%
html_attr("href")
url
results_df <- tibble(names, url)
results_df
results_df <- results_df %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df
results_page2 <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?subtask=browse&field=surname&strtchar=A&page=2")
results %>%
html_nodes("div.subnav a") %>%
html_text()
results_antwerp_engraver %>%
html_nodes("div.subnav a") %>%
html_text()
library(tidyverse)
library(rvest)
results <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?subtask=browse")
results
names <- results %>%
html_nodes("li") %>%
html_text()
names
url <- results %>%
html_nodes("li a") %>%
html_attr("href")
url
results_df <- tibble(names, url)
results_df
results_df <- results_df %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df
results_page2 <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?subtask=browse&field=surname&strtchar=A&page=2")
results %>%
html_nodes("div.subnav a") %>%
html_text()
navigation <- results %>%
html_nodes("div.subnav a") %>%
html_attr("href")
navigation
navigation_engraver <- results_antwerp_engraver %>%
html_nodes("div.subnav a") %>%
html_attr("href")
navigation_engraver
nav_df <- tibble(navigation)
nav_df
nav_df <- tibble(navigation_engraver)
nav_df
nav_results_list <- tibble(
html_results = map(nav_df$url[1:3],
~ {
#url[1:3] - limiting to the first three summary results pages (each page = 50 results)
Sys.sleep(2)
# DO THIS!  sleep 2 will pause 2 seconds between server requests to avoid being identified and potentially blocked by my target web server that might see my crawling bot as a DNS attack.
.x %>%
read_html()
}),
summary_url = nav_df$url[1:3]
)
nav_results_list
library(tidyverse)
library(rvest)
results <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?subtask=browse")
results
names <- results %>%
html_nodes("li") %>%
html_text()
names
url <- results %>%
html_nodes("li a") %>%
html_attr("href")
url
results_df <- tibble(names, url)
results_df
results_df <- results_df %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{url}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
results_df
results_page2 <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?subtask=browse&field=surname&strtchar=A&page=2")
results %>%
html_nodes("div.subnav a") %>%
html_text()
navigation <- results %>%
html_nodes("div.subnav a") %>%
html_attr("href")
navigation
nav_df <- tibble(navigation)
nav_df
nav_df <- nav_df %>%
filter(str_detect(navigation, "&page=")) %>%
distinct(navigation) %>%
mutate(page_no = str_extract(navigation, "\\d+$")) %>%
mutate(page_no = as.numeric(page_no))
nav_df
nav_df <- nav_df %>%
mutate(navigation = str_extract(navigation, ".*(?=\\=\\d+$)")) %>%
mutate(page_no = as.integer(str_replace(page_no, "^2$", "1"))) %>%
expand(navigation, page_no = full_seq(page_no, 1)) %>%
transmute(url = glue::glue("http://www.vondel.humanities.uva.nl{navigation}={page_no}"))
# the regular expression '.*(?=\\=\\d+$)' can be read as:
# capture/find data found BEFORE '(?=<<pattern>>)' the pattern.
# The pattern is =<digit><digit>,
# the '=' sign has to be "escaped"  '\\='.
# The precise regex pattern syntax has the equal sign followed by a digit '\\d'.
# multiple digits  '+',  i.e. '\\d+'
# Since the digits are found at the end of the value of the variable, use an anchor
# To anchor the end of the regex pattern, use the '$' regex anchor notation.
# Remember, we are matching everything before the pattern.  Match with the wildcard: '.*'
# Honestly, there's no substitute for knowing a bit about regex when you're coding.
#
# See the "work with strings" cheatsheet.  https://rstudio.com/resources/cheatsheets/
nav_df
nav_df <- nav_df %>%
mutate(navigation = str_extract(navigation, ".*(?=\\=\\d+$)")) %>%
mutate(page_no = as.integer(str_replace(page_no, "^2$", "1"))) %>%
expand(navigation, page_no = full_seq(page_no, 1)) %>%
transmute(url = glue::glue("http://www.vondel.humanities.uva.nl{navigation}={page_no}"))
knitr::opts_chunk$set(echo = TRUE)
results_antwerp_engraver <- read_html("http://www.vondel.humanities.uva.nl/ecartico/persons/index.php?occupation_id=81%2C121%2C152&subjectmat=&place=antwerpen&gender=male&year_start=1556&year_end=1725&formtype=selections&page=1&subtask=selections")
#results_antwerp_engraver
results_antwerp_engraver %>%
html_nodes("div.subnav a") %>%
html_text()
navigation_engraver <- results_antwerp_engraver %>%
html_nodes("div.subnav a") %>%
html_attr("href")
navigation_engraver
nav_df_engraver <- tibble(navigation_engraver)
nav_df_engraver
nav_df <- nav_df %>%
mutate(navigation = str_extract(navigation, ".*(?=\\=\\d+$)")) %>%
mutate(page_no = as.integer(str_replace(page_no, "^2$", "1"))) %>%
expand(navigation, page_no = full_seq(page_no, 1)) %>%
transmute(url = glue::glue("http://www.vondel.humanities.uva.nl{navigation}={page_no}"))
nav_df_engraver <- nav_df_engraver %>%
mutate(navigation_engraver = str_extract(navigation_engraver, ".*(?=\\=\\d+$)")) %>%
mutate(page_no = as.integer(str_replace(page_no, "^2$", "1"))) %>%
expand(navigation_engraver, page_no = full_seq(page_no, 1)) %>%
transmute(url = glue::glue("http://www.vondel.humanities.uva.nl{navigation}={page_no}"))
nav_df_engraver <- nav_df_engraver %>%
mutate(navigation_engraver = str_extract(navigation_engraver, ".*(?=\\=\\d+$)")) %>%
mutate(page_no = as.integer(str_replace(page_no, "^2$", "1"))) %>%
expand(navigation_engraver, page_no = full_seq(page_no, 1)) %>%
transmute(url = glue::glue("http://www.vondel.humanities.uva.nl{navigation}={page_no}"))
nav_df_engraver <- nav_df_engraver %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{navigation_engraver}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
nav_df_engraver <- nav_df_engraver %>%
mutate(base_url = "http://www.vondel.humanities.uva.nl") %>%
mutate(full_url = glue::glue("{base_url}{navigation_engraver}")) %>%
mutate(full_url = str_replace_all(full_url, "\\.\\.", ""))
nav_df_engraver
write_xlsx(x = nav_df_engraver, path = "antwerp_engraver_url.xlsx", col_names = TRUE)
